<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tittle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
    >
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .chart-box {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            height: 100%;
        }

        canvas {
            max-height: 280px;
        }
    </style>
</head>

<body class="bg-light">

<div class="container mt-5">

    <h1 class="text-center mb-4">Reporte del Sistema</h1>


    <form method="get" class="row g-3 mb-4">
        <div class="col-md-4">
            <label class="form-label">Fecha pedido (inicio)</label>
            <input type="date" name="fecha_pedido" class="form-control"
                   value="{{ request.GET.fecha_pedido }}">
        </div>
        <div class="col-md-4">
            <label class="form-label">Fecha entrega requerida (fin)</label>
            <input type="date" name="fecha_entrega_requerida" class="form-control"
                   value="{{ request.GET.fecha_entrega_requerida }}">
        </div>
        <div class="col-md-4 d-flex align-items-end">
            <button class="btn btn-primary w-100">Filtrar</button>
        </div>
    </form>


    <div class="row g-4">
        <div class="col-md-6">
            <div class="chart-box">
                <h5 class="text-center mb-3">Pedidos por Estado</h5>
                <canvas id="estadoChart"></canvas>
            </div>
        </div>
        <div class="col-md-6">
            <div class="chart-box">
                <h5 class="text-center mb-3">Pedidos por Plataforma</h5>
                <canvas id="origenChart"></canvas>
            </div>
        </div>
    </div>



<script>
const estadoData = {
    labels: [{% for e in pedidos_por_estado %}"{{ e.estado }}",{% endfor %}],
    datasets: [{
        label: "Cantidad",
        data: [{% for e in pedidos_por_estado %}{{ e.total }},{% endfor %}],
        backgroundColor: "#0d6efd"
    }]
};

new Chart(document.getElementById("estadoChart"), {
    type: "bar",
    data: estadoData,
    options: {
        responsive: true,
        plugins: {
            legend: { display: false }
        }
    }
});

const origenData = {
    labels: [{% for o in pedidos_por_origen %}"{{ o.origen }}",{% endfor %}],
    datasets: [{
        label: "Cantidad",
        data: [{% for o in pedidos_por_origen %}{{ o.total }},{% endfor %}],
        backgroundColor: "#198754"
    }]
};

new Chart(document.getElementById("origenChart"), {
    type: "bar",
    data: origenData,
    options: {
        responsive: true,
        plugins: {
            legend: { display: false }
        }
    }
});
</script>

</body>
</html>
